CREATE OR REPLACE VIEW VW_ACCEPTING_REJECT_DETAILS_PRINT
AS
select 
orders.order_id,
print_custom_order_id,
print_order_no,
orders.print_requisition_id, 
print_custom_requisition_id, 
customized,
custom_requisition,
issued_date AS Actual_Issued_Date,
(case when customized='Y' then custom_orders.received_date else  orders.actual_delivery_date end) AS Actual_Delivery_Date,
issue_min_date,
issue_max_date,
transaction_id,
delivery_min_date,
delivery_max_date,
category_name,
style_code,
designer_code,
color_code,
product_codes,
item_code, 
production_types,
print_code,
printing_type,
print_colour,
num_screens_blocks,
num_colours,
(case when customized='Y' then custom_orders.print_length else requis.print_length end) AS print_length,
(case when customized='Y' then custom_orders.print_width else requis.print_width end) AS print_width,
(case when customized='Y' then custom_orders.print_pcs else requis.print_pcs end) AS print_pcs,
(case when customized='Y' then custom_orders.print_total_measurement else requis.print_total_measurement end) AS print_total_measurement,
    custom_orders.designer_not_accepted_reason,
    custom_orders.designer_not_accepted_date,
orders.issued,
custom_orders.order_id AS custom_order_id,
custom_orders.designer_received AS custom_designer_received,
custom_orders.designer_rejected,
custom_orders.designer_returned,
orders.delivered,
orders.designer_received AS designer_received
FROM TRACKER_ORDERS_PRINT orders
LEFT JOIN TRACKER_CUSTOM_RECEIVED_ORDERS_PRINT custom_orders ON custom_orders.order_id=orders.order_id
JOIN TRACKER_REQUISITION_PRINT requis ON orders.print_requisition_id=requis.print_requisition_id;
