CREATE OR REPLACE VIEW VW_ACCEPTING_REJECT_DETAILS_DYE                                
AS
select 
orders.order_id,
dye_custom_order_id,
dye_order_no,
orders.dye_requisition_id, 
dye_custom_requisition_id, 
customized,
custom_requisition,
issued_date AS Actual_Issued_Date,
(case when customized='Y' then custom_orders.received_date else  orders.actual_delivery_date end) AS Actual_Delivery_Date,
issue_min_date,
issue_max_date,
transaction_id,
delivery_min_date,
delivery_max_date,
category_name,
style_code,
designer_code,
color_code,
product_codes,
item_code, 
production_types,
dye_code,
fabric_code,
fabric_name,
fabric_type,
(case when customized='Y' then custom_orders.dye_length else requis.dye_length end) AS dye_length,
(case when customized='Y' then custom_orders.dye_width else requis.dye_width end) AS dye_width,
(case when customized='Y' then custom_orders.dye_pcs else requis.dye_pcs end) AS dye_pcs,
(case when customized='Y' then custom_orders.dye_total_measurement else requis.dye_total_measurement end) AS dye_total_measurement,
    custom_orders.designer_not_accepted_reason,
    custom_orders.designer_not_accepted_date,
orders.issued,
custom_orders.order_id AS custom_order_id,
custom_orders.designer_received AS custom_designer_received,
custom_orders.designer_rejected,
custom_orders.designer_returned,
orders.delivered,
orders.designer_received AS designer_received
FROM TRACKER_ORDERS_DYE orders
LEFT JOIN TRACKER_CUSTOM_RECEIVED_ORDERS_DYE custom_orders ON custom_orders.order_id=orders.order_id
JOIN TRACKER_REQUISITION_DYE requis ON orders.dye_requisition_id=requis.dye_requisition_id;
